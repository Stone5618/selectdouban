# 豆瓣电影 Top 250 数据分析项目

## 一、项目概述

项目地址:https://github.com/Stone5618/selectdouban

本项目旨在爬取豆瓣电影 Top 250 的相关数据，并对这些数据进行可视化分析，以展示电影的年份分布、评分分布、评价人数与评分关系、评论人数 Top 10  电影以及电影类型词云等信息，同时编写了一个简单的图形用户界面（GUI）方便用户进行数据分析结果的查看。

## 二、功能特性

1. **数据爬取**：从豆瓣电影 Top 250 页面获取电影的序号、标题、链接、导演、评分、评价人数、简介、年份、地区、类型等信息，并存储为 Excel 和 CSV 文件。
2. 数据可视化
   - **年份分布柱状图**：展示电影在不同年份的数量分布情况。
   - **评分分布饼图**：呈现电影评分的分布比例。
   - **评价人数随评分变化散点图**：反映评价人数与评分之间的关系。
   - **评论人数 Top 10 水平条形图**：列出评论人数最多的 10 部电影及其评论人数。
   - **电影类型词云图**：直观显示电影类型的频率分布。
3. **GUI 界面**：通过图形用户界面，用户可以轻松选择不同的数据分析选项，并查看相应的可视化结果。

## 三、技术栈

1. **数据爬取**：使用 `requests` 库发送 HTTP 请求获取网页内容，`lxml` 库进行 HTML 解析。
2. **数据处理与分析**：`pandas` 库用于数据的整理和分析。
3. **数据可视化**：`matplotlib` 库绘制各种图表，`wordcloud` 库生成词云图。
4. **GUI 开发**：`tkinter` 库构建图形用户界面，`PIL` 库用于处理图像显示。

## 四、使用说明

### （一）运行环境

本项目基于 Python 开发，确保已经安装了以下依赖库：`os`、`requests`、`lxml`、`pandas`、`matplotlib`、`tkinter`、`PIL`、`wordcloud`。

### （二）运行步骤

1. 直接运行 `main.py` 文件。
2. 程序首先会检查是否已经存在 `豆瓣电影top250数据.csv` 和 `豆瓣电影top250数据.xlsx` 文件。如果文件已存在，则跳过数据爬取步骤；若不存在，则自动启动数据爬取程序，从豆瓣电影 Top 250 页面抓取数据并保存到本地文件。
3. 随后，图形用户界面（GUI）将会启动，界面中包含以下按钮：
   - **Top250 年份分布条状图**：点击后绘制并展示豆瓣电影 Top 250 的年份分布柱状图。
   - **豆瓣电影 Top 250 评分分布饼图**：点击可查看评分分布饼图。
   - **评价人数随评分变化散点图**：生成评价人数随评分变化的散点图。
   - **评论人数 TOP10 条状图**：展示评论人数最多的 10 部电影的条形图。
   - **电影类型词云图**：呈现电影类型的词云图。

### （三）注意事项

1. 由于豆瓣网站的结构可能会发生变化，若网页结构调整，本项目的爬取代码可能需要相应修改以适应新的结构。
2. 数据爬取过程可能受到网络状况和豆瓣服务器限制的影响，如果出现爬取失败或数据不准确的情况，可以尝试重新运行程序或检查网络连接。

## 五、文件结构说明

- `main.py`：项目的主程序文件，包含了数据爬取、数据分析、GUI 构建等主要逻辑。
- `豆瓣电影top250数据.xlsx`：存储爬取到的豆瓣电影 Top 250 数据的 Excel 文件（如果成功爬取生成）。
- `豆瓣电影top250数据.csv`：存储爬取到的豆瓣电影 Top 250 数据的 CSV 文件（如果成功爬取生成）。
- 各个可视化结果图片文件（如 `year_distribution.png`、`rating_distribution.png` 等）：在相应的可视化分析操作后生成，用于在 GUI 中展示或本地查看分析结果。

## 六、项目说明

 欢迎对本项目进行改进和完善，如果有任何修改建议或发现的问题，请提交 issue 或 pull request。在进行修改时，请遵循以下规范：

1. 提交代码前确保代码能够正常运行，并且已经进行了必要的测试。
2. 对于新功能的添加或现有功能的修改，请在代码中添加适当的注释说明修改的目的和逻辑。
3. 遵循代码的现有风格和结构，保持代码的可读性和可维护性。

## 七、许可证

本项目遵循 [MIT 许可证](https://opensource.org/licenses/MIT)，可以自由使用、修改和分发。